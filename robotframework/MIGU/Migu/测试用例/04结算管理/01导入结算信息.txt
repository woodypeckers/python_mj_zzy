*** Settings ***
Suite Teardown    teardown_案例集结束时关闭浏览器
Resource          ../../Resource/Action/04结算管理/01导入结算信息.txt

*** Test Cases ***
01导入结算信息，只有一条正确记录
    [Tags]    smoke
    插入正式的partner端账号
    登录admin端    zbadmin
    进入左侧二级菜单    结算对账(导入)    CP结算信息
    进入导入界面    导入结算
    创建excel文件
    设置导入文件表头    结算月,合作编码,公司中文名称,开票金额,开票税率,流程节点,备注说明,结算状态
    表中插入一行记录    201301,${sp_code},${cn_name},899.111,18.76%,可结算,结算已完成,已结束
    选择导入文件
    点击按钮    导入
    点击按钮    提交
    校验二次确认框提示信息且点击按钮    本次导入共有1条数据，丢弃错误记录0条，成功导入1条记录！
    展开查询框
    管理员端结算信息输入查询条件    ${yx_code}    201301    ${cn_name}    ${sp_code}
    删除excel文件
    [Teardown]    teardown_案例运行失败时关闭浏览器

02导入结算信息，互娱编码不存在
    [Tags]    smoke
    登录admin端    zbadmin
    进入左侧二级菜单    结算对账(导入)    CP结算信息
    进入导入界面    导入结算
    创建excel文件
    设置导入文件表头    结算月,合作编码,公司中文名称,开票金额,开票税率,流程节点,备注说明,结算状态
    表中插入一行记录    201301,9999000,${EMPTY},899.111,18.76%,可结算,结算已完成,已结束
    选择导入文件
    点击按钮    导入
    导入错误结果校验    合作签约方+合作编码对应的合作需存在系统中且为商用或退出状态
    删除excel文件
    [Teardown]    teardown_案例运行失败时关闭浏览器

03导入结算信息，导入文件记录为空
    [Tags]    smoke
    登录admin端    zbadmin
    进入左侧二级菜单    结算对账(导入)    CP结算信息
    进入导入界面    导入结算
    创建excel文件
    设置导入文件表头    结算月,合作编码,公司中文名称,开票金额,开票税率,流程节点,备注说明,结算状态
    选择导入文件
    点击按钮    导入
    校验二次确认框提示信息且点击按钮    上传的EXCEL文件中没有数据，请检查后重新上传！
    删除excel文件
    [Teardown]    teardown_案例运行失败时关闭浏览器

04导入结算信息，导入文件中只有一条错误记录
    [Tags]    smoke
    登录admin端    zbadmin
    进入左侧二级菜单    结算对账(导入)    CP结算信息
    进入导入界面    导入结算
    创建excel文件
    设置导入文件表头    结算月,合作编码,公司中文名称,开票金额,开票税率,流程节点,备注说明,结算状态
    表中插入一行记录    201301,9999000,${EMPTY},899.111,18.76%,可结算,结算已完成,已结束
    选择导入文件
    点击按钮    导入
    点击按钮    忽略错误
    校验二次确认框提示信息且点击按钮    本次导入操作共有1条错误记录，请确认是否忽略错误记录！
    点击按钮    提交
    直到元素可见    jquery=span:contains('正确结果')
    校验二次确认框提示信息且点击按钮    正确结果数为0，无法导入!
    删除excel文件
    [Teardown]    teardown_案例运行失败时关闭浏览器

05导入结算信息，导入记录结算月为空
    [Tags]    smoke
    登录admin端    zbadmin
    进入左侧二级菜单    结算对账(导入)    CP结算信息
    进入导入界面    导入结算
    创建excel文件
    设置导入文件表头    结算月,合作编码,公司中文名称,开票金额,开票税率,流程节点,备注说明,结算状态
    表中插入一行记录    ${EMPTY},9999000,${EMPTY},899.111,18.76%,可结算,结算已完成,已结束
    选择导入文件
    点击按钮    导入
    导入错误结果校验    第2行;请正确填写结算月;
    删除excel文件
    [Teardown]    teardown_案例运行失败时关闭浏览器

06导入结算信息，导入记录互娱合作编码为空
    [Tags]    smoke
    登录admin端    zbadmin
    进入左侧二级菜单    结算对账(导入)    CP结算信息
    进入导入界面    导入结算
    创建excel文件
    设置导入文件表头    结算月,合作编码,公司中文名称,开票金额,开票税率,流程节点,备注说明,结算状态
    表中插入一行记录    201302,${EMPTY},${EMPTY},899.111,18.76%,可结算,结算已完成,已结束
    选择导入文件
    点击按钮    导入
    导入错误结果校验    第2行;请正确填写合作编码;
    删除excel文件
    [Teardown]    teardown_案例运行失败时关闭浏览器

07导入结算信息，导入记录开票金额为空
    [Tags]    smoke
    登录admin端    zbadmin
    进入左侧二级菜单    结算对账(导入)    CP结算信息
    进入导入界面    导入结算
    创建excel文件
    设置导入文件表头    结算月,合作编码,公司中文名称,开票金额,开票税率,流程节点,备注说明,结算状态
    表中插入一行记录    201302,9999000,${EMPTY},${EMPTY},18.76%,可结算,结算已完成,已结束
    选择导入文件
    点击按钮    导入
    导入错误结果校验    第2行;请正确填写开票金额;
    删除excel文件
    [Teardown]    teardown_案例运行失败时关闭浏览器
